import{f as e,h as a,u as t,g as r,r as l,A as s,j as o,w as n,n as i,q as u,s as d,v as c,o as p,c as g,x as m,k as v,a as b,b as x,d as h,t as y,e as k,y as f,z as w}from"./C0ajcZnf.js";import{u as j,_ as $}from"./C70uoV0X.js";import{W as P}from"./DOtyZyZM.js";import{_ as S}from"./fRG3YhlW.js";import{u as W}from"./BHEbfMk0.js";import"./cETb8_vR.js";import"./CyJ4Y1vI.js";const A={key:0,class:"py-12 text-center"},C={class:"text-xs text-left bg-red-100 p-4 rounded max-w-xl mx-auto mb-4 border border-red-300"},L={class:"mt-1 text-xs whitespace-pre-wrap break-all bg-white p-2 border rounded"},R={key:1,class:"py-12 text-center"},_={class:"mt-3 text-gray-500 max-w-md mx-auto mb-6"},q={key:2},z={class:"max-w-3xl mx-auto px-6 pt-8"},I={class:"flex items-center justify-between"},N={class:"flex items-center gap-2"},E={class:"flex items-center"},F={class:"text-sm text-brand-primary dark:text-primary-300"},B={key:0,class:"mx-1"},D={key:1},M={class:"font-medium text-brand-primary dark:text-primary-300"},O={class:"max-w-3xl mx-auto h-40 md:h-48 relative overflow-visible"},U=["src"],G={class:"text-brand-900 dark:text-brand-100 tracking-tight text-7xl leading-[86px] max-md:text-6xl max-md:leading-[66px] max-sm:text-4xl max-sm:leading-10 mt-8 mb-10 border-b border-brand-50 dark:border-primary-700 pb-4"},H={class:"prose prose-slate max-w-none dark:prose-invert"},J={key:0,class:"mt-8 pt-4 border-t border-brand-50 dark:border-primary-700 text-sm text-brand-primary dark:text-primary-300"},T=e({__name:"[slug]",async setup(e){let T,K;const Y=u();d();const Q=t(),V=a((()=>{const e=Y.params.slug;return Array.isArray(e)?e[e.length-1]:e})),X=Q.public.payloadApiFullUrl,{getMediaUrl:Z}=c(),ee=a((()=>`wiki-page-${Y.fullPath}`)),{data:ae,pending:te,error:re}=([T,K]=r((()=>W((()=>{if(!X)throw console.error(`Wiki Slug Page: Payload API URL is not configured for slug ${V.value}.`),i({statusCode:500,statusMessage:"API URL not configured"});return`${X}/wiki-pages?where[slug][equals]=${V.value}&limit=1`}),{key:ee.value,cache:"no-cache",onRequestError({request:e,options:a,error:t}){console.error(`Wiki Slug Page: Error in useFetch for slug ${V.value} from ${e}:`,t)}},"$RR2R3YK0JI"))),T=await T,K(),T),le=a((()=>ae.value?.docs?.[0])),se=l([]);s((async()=>{if(le.value&&le.value.parent&&"object"==typeof le.value.parent&&le.value.parent.id){const a=le.value.parent,t=a.id,r=a.title||"Related Pages";try{const e=await $fetch(`/api/wiki-nav?parentId=${t}`);se.value=[{id:t,name:r,pages:e.map((e=>({id:e.id,slug:e.slug,title:e.title})))}]}catch(e){console.error("Failed to fetch sibling navigation data for PagePrevNextNav:",e),se.value=[]}}else se.value=[]}));const oe=a((()=>{const e=le.value?.backgroundSettings,a=e?.backgroundImage;return"object"==typeof a&&null!==a&&"url"in a&&a.url?a.url.startsWith("http://")||a.url.startsWith("https://")?a.url:Z(a):"string"==typeof a?a.startsWith("http://")||a.startsWith("https://")?a:Z(a):void 0})),ne=a((()=>le.value?.backgroundSettings?.backgroundOverlay||null)),ie=a((()=>{const e=ne.value;return e&&/^(primary-(25|50|100|200|300|400|500|600|700|800|900|950)|sand|pink-light|coral-light|pink-mid|purple-light|blue-light|aqua-light|green-light|light-green|grass-light|light-grey|navy-dark)$/.test(e)?`bg-${e}`:"bg-gradient-to-r from-indigo-500 to-purple-600"})),ue=a((()=>{const e=ne.value,a=e&&/^primary-(25|50|100|200|300|400|500|600|700|800|900|950)$/.test(e);return!!oe.value||a})),de=a((()=>(e=>{if(!e)return null;try{return new Date(e).toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"numeric"})}catch(a){return console.error("Error formatting date:",a),null}})(le.value?.updatedAt))),ce=l(!1);return j(le.value,"article"),(e,a)=>{const t=k,r=f;return p(),o(P,{"nav-parent-id":null,"nav-title":"Wiki Menu",isLeftSidebarOpen:ce.value,onCloseLeftSidebar:a[3]||(a[3]=e=>ce.value=!1)},{default:n((()=>[v(re)?(p(),g("div",A,[a[10]||(a[10]=b("div",{class:"w-24 h-24 mx-auto mb-6 text-4xl"},"ðŸ”",-1)),a[11]||(a[11]=b("h1",{class:"text-3xl font-bold text-gray-700 mb-3"},"Error Loading Page",-1)),a[12]||(a[12]=b("p",{class:"mt-3 text-gray-500 max-w-md mx-auto mb-6"}," Could not load the requested page. Please try again later. ",-1)),b("div",C,[a[7]||(a[7]=b("p",null,[b("strong",null,"Debug Info:")],-1)),b("p",null,[a[4]||(a[4]=h(" Requested Slug: ")),b("code",null,y(V.value),1)]),b("p",null,[a[5]||(a[5]=h(" Fetch Error Message: ")),b("code",null,y(v(re)?.message||"None"),1)]),b("p",null,[a[6]||(a[6]=h(" Fetch Status Code: ")),b("code",null,y(v(re)?.statusCode||"N/A"),1)]),a[8]||(a[8]=b("p",null,"Error Data:",-1)),b("pre",L,y(JSON.stringify(v(re)?.data,null,2)||"N/A"),1)]),x(t,{to:"/wiki",class:"inline-flex items-center px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90"},{default:n((()=>a[9]||(a[9]=[b("span",{class:"mr-1"},"â†",-1),h(" Back to Wiki Home ")]))),_:1})])):le.value||v(te)?m("",!0):(p(),g("div",R,[a[16]||(a[16]=b("div",{class:"w-24 h-24 mx-auto mb-6 text-4xl"},"ðŸ¤·",-1)),a[17]||(a[17]=b("h1",{class:"text-3xl font-bold text-gray-700 mb-3"},"Page Not Found",-1)),b("p",_,[a[13]||(a[13]=h(" The wiki page you're looking for doesn't exist or has been moved. (Slug: ")),b("code",null,y(V.value),1),a[14]||(a[14]=h(") "))]),x(t,{to:"/wiki",class:"inline-flex items-center px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90"},{default:n((()=>a[15]||(a[15]=[b("span",{class:"mr-1"},"â†",-1),h(" Back to Wiki Home ")]))),_:1})])),le.value?(p(),g("div",q,[b("div",z,[b("div",I,[b("div",N,[b("div",E,[b("button",{onClick:a[0]||(a[0]=a=>e.$router.back()),class:"p-1 rounded hover:bg-brand-100 dark:hover:bg-slate-700 text-brand-400 hover:text-brand-500 dark:hover:text-brand-300","aria-label":"Go back"},[x(r,{name:"ph:arrow-left",size:"16"})]),b("button",{onClick:a[1]||(a[1]=a=>e.$router.forward()),class:"p-1 rounded hover:bg-brand-100 dark:hover:bg-slate-700 text-brand-400 hover:text-brand-500 dark:hover:text-brand-300","aria-label":"Go forward"},[x(r,{name:"ph:arrow-right",size:"16"})])]),b("div",F,[x(t,{to:"/wiki",prefetch:"",class:"hover:text-brand-primary/80 dark:hover:text-primary-200"},{default:n((()=>a[18]||(a[18]=[h("Wiki")]))),_:1}),le.value.category&&"object"==typeof le.value.category?(p(),g("span",B,"/")):m("",!0),le.value.category&&"object"==typeof le.value.category?(p(),g("span",D,y(le.value.category.name),1)):m("",!0),a[19]||(a[19]=b("span",{class:"mx-1"},"/",-1)),b("span",M,y(le.value.title),1)]),b("button",{onClick:a[2]||(a[2]=e=>ce.value=!0),class:"p-1 rounded hover:bg-brand-100 text-gray-500 hover:text-gray-600 ml-auto lg:hidden","aria-label":"Toggle table of contents"},[x(r,{name:"ph:list",size:"16"})])])])]),ue.value?(p(),g("div",{key:0,class:w(["mt-5 mb-16 mx-5 rounded-lg relative overflow-visible",ie.value])},[b("div",O,[oe.value?(p(),g("img",{key:0,src:oe.value,alt:"Page Icon",class:"absolute left-8 -bottom-20 h-72 w-72 object-contain z-10"},null,8,U)):(p(),o(r,{key:1,name:"ph:book-open",size:"288",class:"absolute left-8 -bottom-20 text-white z-10"}))])],2)):m("",!0),b("div",{class:w(["max-w-3xl mx-auto px-6 pb-8",{"pt-8":!ue.value}])},[b("article",null,[b("h1",G,y(le.value.title),1),b("div",H,[x($,{blocks:le.value.pageBuilder||[]},null,8,["blocks"])]),de.value?(p(),g("div",J," Last updated: "+y(de.value),1)):m("",!0)]),se.value&&se.value.length>0&&se.value[0]&&se.value[0].pages&&se.value[0].pages.length>1&&le.value&&V.value?(p(),o(S,{key:0,"nav-data":se.value,"current-page-slug":V.value,section:"wiki"},null,8,["nav-data","current-page-slug"])):m("",!0)],2)])):m("",!0)])),_:1},8,["isLeftSidebarOpen"])}}});export{T as default};
