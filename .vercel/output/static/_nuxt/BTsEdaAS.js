import{r as e,p as a,i as r,f as t,u as s,h as l,g as o,j as n,w as i,q as u,v as d,s as c,o as g,c as v,k as p,a as m,b,t as h,e as y,d as x,x as f,y as k,z as w}from"./C0ajcZnf.js";import{_ as $}from"./fRG3YhlW.js";import{s as j}from"./DAViBy51.js";import{u as R,_ as S}from"./C70uoV0X.js";import{R as I}from"./xlVzH5Ss.js";import{u as P}from"./BHEbfMk0.js";import"./cETb8_vR.js";import"./CyJ4Y1vI.js";const A={key:0,class:"py-12 text-center"},E={class:"mt-3 text-gray-500 max-w-md mx-auto mb-6"},L={key:1},z={class:"max-w-3xl mx-auto px-6 pt-8"},D={class:"flex items-center justify-between mb-4"},_={class:"flex items-center gap-2"},q={class:"flex items-center"},B={class:"text-sm text-brand-primary dark:text-primary-300"},C={key:0,class:"mx-1"},U={key:1},W={class:"font-medium text-brand-primary dark:text-primary-300"},F={class:"max-w-3xl mx-auto h-40 md:h-48 relative overflow-visible"},O=["src"],T={class:"text-brand-900 dark:text-brand-100 tracking-tight text-7xl leading-[86px] max-md:text-6xl max-sm:text-4xl max-sm:leading-10 mt-8 mb-10 border-b border-brand-50 dark:border-primary-700 pb-4"},G={class:"prose prose-slate max-w-none dark:prose-invert"},N={key:0,class:"mt-8 pt-4 border-t border-brand-50 dark:border-primary-700 text-sm text-brand-primary dark:text-primary-300"},H=t({__name:"[slug]",async setup(t){let H,M;const{getMediaUrl:J}=d(),K=u();c();const Q=s().public.payloadApiFullUrl,V=e("registry"),{navData:X}=function(t){const s=e(null),l=e(!0),o=e(null),n=e(!1);a((()=>{n.value=!0}));const i=async e=>{if(e){l.value=!0,o.value=null;try{const a=`/api/navigation?section=${e}`,r=`navigation-${e}-${Date.now()}`,{data:t,error:l}=await P(a,{key:r,headers:{"Cache-Control":"no-cache"},onResponseError(e){if(404!==e.response.status)throw new Error(`API Error: ${e.response.statusText}`)},suspense:!1},"$I4Dx1f3bIj");if(l.value)throw l.value;t.value&&Array.isArray(t.value)?s.value=t.value:s.value=[]}catch(a){console.error(`Navigation fetch error for section ${e}:`,a),o.value=a instanceof Error?a:new Error("Unknown error fetching navigation"),s.value=[]}finally{l.value=!1}}};return r(t,((e,a)=>{e&&e!==a&&i(e)}),{immediate:!0}),{navData:s,loading:l,error:o,refresh:()=>{t.value&&i(t.value)}}}(V),Y=l((()=>{const e=K.params.slug;return Array.isArray(e)?e[e.length-1]:e})),Z=l((()=>`registry-page-${K.fullPath}`)),{data:ee,pending:ae,error:re}=([H,M]=o((()=>P((()=>`/registry-pages?where[slug][equals]=${Y.value}&depth=2&limit=1`),{baseURL:Q,key:Z.value,transform:async e=>Q?e&&e.docs?e:(console.warn(`Registry Slug Page: No docs found in page response for slug ${Y.value} or response is null.`),{docs:[]}):(console.error(`Registry Slug Page: Payload API URL is not configured for slug ${Y.value}.`),{docs:[]}),onRequestError({request:e,options:a,error:r}){console.error(`Registry Slug Page: Error fetching page data for slug ${Y.value} from ${a.baseURL}${e}:`,r)},cache:"no-cache",watch:!1},"$0OJ1FDIF11"))),H=await H,M(),H),te=l((()=>ee.value?.docs?.[0])),se=l((()=>{const e=te.value?.backgroundSettings,a=e?.backgroundImage;return"object"==typeof a&&null!==a&&"url"in a&&a.url?a.url.startsWith("http://")||a.url.startsWith("https://")?a.url:J(a):"string"==typeof a?a.startsWith("http://")||a.startsWith("https://")?a:J(a):void 0})),le=l((()=>te.value?.backgroundSettings?.backgroundOverlay)),oe=l((()=>{const e=le.value;return e&&/^(primary-(25|50|100|200|300|400|500|600|700|800|900|950)|sand|pink-light|coral-light|pink-mid|purple-light|blue-light|aqua-light|green-light|light-green|grass-light|light-grey|navy-dark)$/.test(e)?`bg-${e}`:"bg-gradient-to-r from-indigo-500 to-purple-600"})),ne=l((()=>{const e=le.value,a=e&&/^primary-(25|50|100|200|300|400|500|600|700|800|900|950)$/.test(e);return!!se.value||a})),ie=l((()=>(e=>{if(!e)return null;try{return new Date(e).toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"numeric"})}catch(a){return console.error("Error formatting date:",a),null}})(te.value?.updatedAt)));l((()=>te.value?.pageBuilder?te.value.pageBuilder.filter((e=>"sectionHeaderBlock"===e.blockType&&"string"==typeof e.title&&["h1","h2","h3"].includes(e.level||""))).map((e=>{const a=e.title;return{id:e.anchorId?j(e.anchorId,{lower:!0,strict:!0}):j(a,{lower:!0,strict:!0}),text:a,level:e.level||"h2"}})):[])),R(te.value,"article"),e(!1);const ue=e(!1);return a((()=>{window.innerWidth>=1024&&(ue.value=!0)})),(e,a)=>{const r=y,t=k,s=$;return g(),n(I,{"nav-parent-id":null,"nav-title":"Registry Menu",isLeftSidebarOpen:ue.value,onCloseLeftSidebar:a[3]||(a[3]=e=>ue.value=!1)},{default:i((()=>[p(re)||!te.value?(g(),v("div",A,[a[5]||(a[5]=m("div",{class:"w-24 h-24 mx-auto mb-6 text-4xl"},"🔩",-1)),a[6]||(a[6]=m("h1",{class:"text-3xl font-bold text-gray-700 mb-3"}," Registry Page Not Found ",-1)),m("p",E," The registry page you're looking for doesn't exist or has been moved. (Slug: "+h(Y.value)+") ",1),b(r,{to:"/registry",class:"inline-flex items-center px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90"},{default:i((()=>a[4]||(a[4]=[m("span",{class:"mr-1"},"←",-1),x(" Back to Registry Home ")]))),_:1})])):(g(),v("div",L,[m("div",z,[m("div",D,[m("div",_,[m("div",q,[m("button",{onClick:a[0]||(a[0]=a=>e.$router.back()),class:"p-1 rounded hover:bg-brand-100 dark:hover:bg-slate-700 text-brand-400 hover:text-brand-500 dark:hover:text-brand-300","aria-label":"Go back"},[b(t,{name:"ph:arrow-left",size:"16"})]),m("button",{onClick:a[1]||(a[1]=a=>e.$router.forward()),class:"p-1 rounded hover:bg-brand-100 dark:hover:bg-slate-700 text-brand-400 hover:text-brand-500 dark:hover:text-brand-300","aria-label":"Go forward"},[b(t,{name:"ph:arrow-right",size:"16"})])]),m("div",B,[b(r,{to:"/registry",class:"hover:text-brand-primary/80 dark:hover:text-primary-200"},{default:i((()=>a[7]||(a[7]=[x("Registry")]))),_:1}),te.value.category&&"object"==typeof te.value.category?(g(),v("span",C,"/")):f("",!0),te.value.category&&"object"==typeof te.value.category?(g(),v("span",U,h(te.value.category.name),1)):f("",!0),a[8]||(a[8]=m("span",{class:"mx-1"},"/",-1)),m("span",W,h(te.value.title),1)])]),m("button",{onClick:a[2]||(a[2]=e=>ue.value=!0),class:"p-1 rounded hover:bg-brand-100 text-gray-500 hover:text-gray-600 ml-auto lg:hidden","aria-label":"Toggle table of contents"},[b(t,{name:"ph:list",size:"16"})])])]),ne.value?(g(),v("div",{key:0,class:w(["mt-5 mb-16 mx-5 rounded-lg relative overflow-visible",oe.value])},[m("div",F,[se.value?(g(),v("img",{key:0,src:se.value,alt:"Page Icon",class:"absolute left-8 -bottom-20 h-72 w-72 object-contain z-10"},null,8,O)):(g(),n(t,{key:1,name:"ph:squares-four",size:"288",class:"absolute left-8 -bottom-20 text-white z-10"}))])],2)):f("",!0),m("div",{class:w(["max-w-3xl mx-auto px-6 pb-8",{"pt-8":!ne.value}])},[m("article",null,[m("h1",T,h(te.value.title),1),m("div",G,[b(S,{blocks:te.value.pageBuilder||[]},null,8,["blocks"])]),ie.value?(g(),v("div",N," Last updated: "+h(ie.value),1)):f("",!0)]),p(X)&&p(X).length>0&&te.value&&Y.value?(g(),n(s,{key:0,"nav-data":p(X),"current-page-slug":Y.value,section:"registry"},null,8,["nav-data","current-page-slug"])):f("",!0)],2)]))])),_:1},8,["isLeftSidebarOpen"])}}});export{H as default};
